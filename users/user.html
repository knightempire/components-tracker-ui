<!DOCTYPE html>
<html lang="en">

<head>
    <title>Amuda - Dashboard </title>
    <!-- [Meta] -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <script src="https://cdn.tailwindcss.com"></script>


    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" id="main-font-link">
    <!-- [Tabler Icons] https://tablericons.com -->
    <link rel="stylesheet" href="../assets/fonts/tabler-icons.min.css">
    <!-- [Feather Icons] https://feathericons.com -->
    <link rel="stylesheet" href="../assets/fonts/feather.css">
    <!-- [Font Awesome Icons] https://fontawesome.com/icons -->
    <link rel="stylesheet" href="../assets/fonts/fontawesome.css">
    <!-- [Material Icons] https://fonts.google.com/icons -->
    <link rel="stylesheet" href="../assets/fonts/material.css">
    <!-- [Template CSS Files] -->
    <link rel="stylesheet" href="../assets/css/style.css" id="main-style-link">
    <link rel="stylesheet" href="../assets/css/style-preset.css">
    <link rel="stylesheet" href="./css/main.css">
    <script src="./js/main.js"></script>
</head>
<!-- [Head] end -->
<!-- [Body] Start -->

<body>
    <!-- [ Pre-loader ] start -->
    <div class="loader-bg">
        <div class="loader-track">
            <div class="loader-fill"></div>
        </div>
    </div>
    <!-- [ Pre-loader ] End -->
    <!-- [ Sidebar Menu ] start -->
    <nav class="pc-sidebar">
        <div class="navbar-wrapper">
            <div class="m-header">
                <a href="./index.html" class="b-brand text-primary">
                    <!-- ========   Change your logo from here   ============ -->
                    LAB
                </a>
            </div>
            <div class="navbar-content">
                <ul class="pc-navbar">

                    <li class="pc-item">
                        <a href="./index.html" class="pc-link"><span class="pc-micon"><i class="ti ti-dashboard"></i></span><span
              class="pc-mtext">Default</span></a>
                    </li>


                    <li class="pc-item">
                        <a href="./user.html" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-users"></i></span>
                            <span class="pc-mtext">Users</span>
                        </a>
                    </li>
                    <li class="pc-item">
                        <a href="./orders.html" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-tool"></i></span>
                            <span class="pc-mtext">Orders</span>
                        </a>
                    </li>




                </ul>

            </div>
        </div>
    </nav>
    <!-- [ Sidebar Menu ] end -->
    <!-- [ Header Topbar ] start -->
    <header class="pc-header">
        <div class="header-wrapper">
            <!-- [Mobile Media Block] start -->
            <div class="me-auto pc-mob-drp">
                <ul class="list-unstyled">
                    <li class="pc-h-item header-mobile-collapse">
                        <a href="#" class="pc-head-link head-link-secondary ms-0" id="sidebar-hide">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>
                    <li class="pc-h-item pc-sidebar-popup">
                        <a href="#" class="pc-head-link head-link-secondary ms-0" id="mobile-collapse">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>

                    <li class="pc-h-item d-none d-md-inline-flex">
                        <h3>Hello User </h3>
                    </li>
                </ul>
            </div>
            <!-- [Mobile Media Block end] -->
            <div class="ms-auto">
                <ul class="list-unstyled">

                    <li class="dropdown pc-h-item header-user-profile">
                        <a class="pc-head-link head-link-primary dropdown-toggle arrow-none me-0" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                          Logout

                        </a>

                    </li>
                </ul>
            </div>
        </div>
    </header>
    <!-- [ Header ] end -->



    <!-- [ Main Content ] start -->
    <div class="pc-container">
        <div class="pc-content">
            <!-- [ Main Content ] start -->


            <div class="row">
                <!-- [ sample-page ] start -->

                <!-- Card 1 -->
                <div class="col-xl-3 col-md-6">
                    <div class="card dashnum-card dashnum-card-small overflow-hidden">
                        <span class="round bg-primary small"></span>
                        <span class="round bg-primary big"></span>
                        <div class="card-body p-3">
                            <div class="d-flex align-items-center">
                                <div class="avtar avtar-lg bg-light-primary">
                                    <i class="text-primary ti ti-wallet"></i>
                                </div>
                                <div class="ms-2">
                                    <h4 class="mb-1" id="Totalstudent">$550K <i class="ti ti-arrow-up-right-circle opacity-50"></i></h4>
                                    <p class="mb-0 opacity-50 text-md">Total student </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 2 -->
                <div class="col-xl-3 col-md-6">
                    <div class="card dashnum-card dashnum-card-small overflow-hidden">
                        <span class="round bg-warning small"></span>
                        <span class="round bg-warning big"></span>
                        <div class="card-body p-3">
                            <div class="d-flex align-items-center">
                                <div class="avtar avtar-lg bg-light-warning">
                                    <i class="text-warning ti ti-credit-card"></i>
                                </div>
                                <div class="ms-2">
                                    <h4 class="mb-1" id="Totalfaculty">$550K <i class="ti ti-arrow-up-right-circle opacity-50"></i></h4>
                                    <p class="mb-0 opacity-50 text-md"> Total faculty </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 3 -->

                <!-- Two buttons in the rightmost end -->
                <div class="col-xl-3 col-md-3 ms-auto d-flex justify-content-end align-items-center gap-3">
                    <!-- The buttons won't take up the entire height of the row, and they will be centered vertically within their column -->
                    <!-- <button class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300">
                        Update product
                    </button> -->
                    <button class="bg-purple-500 text-white px-6 py-2 rounded-lg hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300" onclick="display()">
                        Add User
                    </button>
                </div>

                <!-- [ sample-page ] end -->
            </div>

            <div class="flex justify-center items-center hidden" id="msgok">
                <div class="flex flex-col gap-2 w-60 sm:w-72 text-[10px] sm:text-xs z-50">
                    <div class="success-alert cursor-default flex items-center justify-between w-full h-12 sm:h-14 rounded-lg bg-[#232531] px-[10px]">
                        <div class="flex gap-2">
                            <div class="text-[#2b9875] bg-white/5 backdrop-blur-xl p-1 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-white"> successfully :)</p>
                                <p class="text-gray-500" id="Msg">Product added</p>
                            </div>
                        </div>
                        <button class="text-gray-600 text-gray-600 hover:bg-white/5 p-1 rounded-md transition-colors ease-linear">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="flex justify-center items-center flex-col gap-2  text-[10px] hidden" id="msgfail">
                <div class="error-alert cursor-default flex items-center justify-between w-full h-12 sm:h-14 rounded-lg bg-[#232531] px-[10px]">
                    <div class="flex gap-2">
                        <div class="text-[#d65563] bg-white/5 backdrop-blur-xl p-1 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                <path
                                  stroke-linecap="round"
                                  stroke-linejoin="round"
                                  d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"
                                ></path>
                            </svg>
                        </div>
                        <div>
                            <p class="text-white">Please try again</p>
                            <p class="text-gray-500" id="Msgerr">This is the description part</p>
                        </div>
                    </div>
                    <button class="text-gray-600 hover:bg-white/10 p-1 rounded-md transition-colors ease-linear">
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke-width="1.5"
                          stroke="currentColor"
                          class="w-6 h-6"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M6 18 18 6M6 6l12 12"
                          ></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="mainscreen" id="mainscreen">
                <div class="row mt-4">
                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-header flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <!-- Title and Search Bar within the same flex container -->
                                <div class="flex w-full items-center sm:w-auto sm:mr-4">
                                    <!-- Title as a div (stays on the left) -->
                                    <div class="text-3xl font-bold sm:mr-4">Users list</div>
                                </div>

                                <!-- Search Bar (Stacked below on small screens) -->
                                <div class="relative sm:w-64 w-full">
                                    <!-- Feather Search Icon and Input -->
                                    <i data-feather="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"></i>
                                    <input id="searchInput" type="search" class="pl-10 pr-4 py-2 border border-black rounded-lg shadow-none focus:outline-none w-full" placeholder="Search by Roll No or Name...">
                                </div>

                            </div>

                            <div class="card-body">
                                <!-- Add a wrapper div to make the table scrollable on smaller screens -->
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-blue-100">
                                            <tr>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Name
                                                </th>
                                                <!-- <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                    Title
                                                </th> -->
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    User type
                                                </th>

                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    comppoents
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Total Issue
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Actions
                                                </th>
                                            </tr>
                                        </thead>

                                        <tbody class="bg-white divide-y divide-gray-200" id="displayusers">
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <div class="flex items-center">
                                                        <div class="ml-4">
                                                            <div class="text-sm font-medium text-gray-900" id="name">
                                                                Abinesh
                                                            </div>
                                                            <div class="text-md text-gray-700" id="roll_no">
                                                                cb.en.u4cse21302
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap">
                                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800" id="user_type">
                                                        student
                                                    </span>
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap text-md text-gray-900" id="phone">
                                                    9499964935
                                                </td>


                                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                    <div class="ml-4">
                                                        <div class="text-md font-medium text-gray-900">
                                                            Components issue : <span id="total_component_count"> 100</span>
                                                        </div>
                                                        <div class="text-md text-gray-900">
                                                            Total no of issue : <span id="total_component_count_not_returned"> 10</span>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-md text-gray-900" id="total_issue_count">
                                                    10
                                                </td>
                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                    <button class="px-4 py-2 bg-sky-500 text-white font-bold rounded-md hover:bg-sky-600 transition duration-300 focus:outline-none">View details</button>
                                                    <button class="px-4 py-2 bg-purple-500 text-white font-bold rounded-md hover:bg-purple-600 transition duration-300 focus:outline-none" onclick="pageform()">Update</button>

                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>



                        </div>
                    </div>

                </div>


            </div>


            <div class="form card mt-4 p-6 hidden" id="displaymainform">
                <form id="addForm" onsubmit="crateuser(event)">

                    <div class="mt-6 md:mt-10 text-center font-bold text-3xl font-bold md:text-xl">Add Users</div>


                    <div class="flex flex-wrap -mx-4 mt-6">
                        <div class="w-full md:w-1/2 px-4 mt-4">
                            <label for="name" class="block text-md font-semibold text-gray-700 mb-2">Name</label>
                            <input type="text" id="newname" name="newname" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>

                        <div class="w-full md:w-1/2 px-4 mt-4">
                            <label for="roll_no" class="block text-md font-semibold text-gray-700 mb-2">Roll No</label>
                            <input type="text" id="newroll_no" name="newroll_no" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>
                    </div>

                    <!-- Phone No and User Type Section -->
                    <div class="flex flex-wrap -mx-4 mt-6">
                        <div class="w-full md:w-1/2 px-4 mt-4">
                            <label for="phone" class="block text-md font-semibold text-gray-700 mb-2">Phone No</label>
                            <input type="number" id="newphone" name="newphone" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>

                        <div class="w-full md:w-1/2 px-4 mt-4">
                            <label for="newuser_type" class="block text-md font-semibold text-gray-700 mb-2">User Type</label>
                            <select id="newuser_type" name="newuser_type" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                                <option value="" disabled selected>Choose User Type</option>
                                <option value="0">Student</option>
                                <option value="1">Faculty</option>
                             
                            </select>
                        </div>
                    </div>

                    <div class="flex flex-wrap -mx-4 mt-6">
                        <div class="w-full md:w-1/2 px-4 mt-4">
                            <label for="phone" class="block text-md font-semibold text-gray-700 mb-2">Email</label>
                            <input type="text" id="newemail" name="newemail" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>
                    </div>




                    <!-- Submit Button -->
                    <div class="text-center mt-6">
                        <button type="submit" class="cursor-pointer rounded-lg bg-purple-700 px-6 py-2 sm:py-3 text-md font-semibold text-white mr-4">Submit</button>
                    </div>
                </form>
            </div>






            <br><br><br>


            <script>
                //add button display toggle
                function display() {

                    var mainscreen = document.getElementById('mainscreen');
                    var displaymainform = document.getElementById('displaymainform');
                    var button = document.querySelector('button');



                    if (displaymainform.classList.contains('hidden')) {

                        mainscreen.classList.add('hidden');
                        displaymainform.classList.remove('hidden');

                        button.textContent = 'Close';

                    } else {

                        mainscreen.classList.remove('hidden');
                        displaymainform.classList.add('hidden');
                        button.textContent = 'Add User';

                    }
                }
            </script>

            <!-- Include Feather Icons -->
            <script src="https://unpkg.com/feather-icons"></script>
            <script>
                feather.replace(); // Initializes the Feather Icons
            </script>





        </div>
    </div>

    <footer class="pc-footer">
        <div class="footer-wrapper container-fluid">
            <div class="row">
                <div class="col-sm-6 my-1">
                    <p class="m-0">Components tracker &#9829; crafted by Team <a href="https://themeforest.net/user/Team_name" target="_blank">Team_name</a></p>
                </div>
                <div class="col-sm-6 ms-auto my-1">
                    <ul class="list-inline footer-link mb-0 justify-content-sm-end d-flex">
                        <li class="list-inline-item"><a href="../index.html">Home</a></li>
                        <li class="list-inline-item"><a href="https://Team_name.gitbook.io/Components tracker-bootstrap/" target="_blank">Documentation</a></li>
                        <li class="list-inline-item"><a href="https://Team_name.support-hub.io/" target="_blank">Support</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <!-- Required Js -->
    <script src="../assets/js/plugins/popper.min.js"></script>
    <script src="../assets/js/plugins/simplebar.min.js"></script>
    <script src="../assets/js/plugins/bootstrap.min.js"></script>
    <script src="../assets/js/fonts/custom-font.js"></script>
    <script src="../assets/js/pcoded.js"></script>
    <script src="../assets/js/plugins/feather.min.js"></script>





    <script>
        layout_change('light');
    </script>




    <script>
        font_change("Roboto");
    </script>


    <script>
        change_box_container('false');
    </script>


    <script>
        layout_caption_change('true');
    </script>




    <script>
        layout_rtl_change('false');
    </script>


    <script>
        preset_change("preset-1");
    </script>




</body>

</html>

<script>
    document.getElementById('newuser_type').addEventListener('change', function() {

        const userType = document.getElementById('newuser_type').value;
        const rollNo = document.getElementById('newroll_no').value;
        const emailField = document.getElementById('newemail');


        if (userType === '0') {

            if (rollNo) {
                emailField.value = rollNo + '@cb.students.amrita.edu';
            } else {
                emailField.value = '';
            }
        } else {

            emailField.value = '';
        }
    });


    document.getElementById('newroll_no').addEventListener('input', function() {
        const userType = document.getElementById('newuser_type').value;
        const rollNo = document.getElementById('newroll_no').value;
        const emailField = document.getElementById('newemail');

        if (userType === '0' && rollNo) {
            emailField.value = rollNo + '@cb.students.amrita.edu';
        }
    });


    async function crateuser(event) {
        event.preventDefault();

        // Get form field values
        const name = document.getElementById('newname').value;
        const roll_no = document.getElementById('newroll_no').value;
        const email = document.getElementById('newemail').value;
        const phone = document.getElementById('newphone').value;
        const user_type = document.getElementById('newuser_type').value;

        // Print the values to the console
        console.log('Name:', name);
        console.log('Roll No:', roll_no);
        console.log('Phone No:', phone);
        console.log('User Type:', user_type);
        console.log('Email:', email);

        // Create the data object to send to the API
        const userData = {
            name: name,
            roll_no: roll_no,
            email: email,
            phone_no: phone,
            user_type: user_type
        };

        try {

            const response = await fetch('http://localhost:3002/api/userpage/adduser', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(userData)
            });

            if (!response.ok) {
                const errorMessage = await response.text();
                throw new Error(`Error: ${response.status} - ${errorMessage}`);
            }


            const data = await response.json();
            console.log('Response from API:', data);
            displayusers()
            display();


            const msgOkElement = document.getElementById('msgok');
            const msgTextElement = document.getElementById('Msg');
            msgTextElement.textContent = data.message || "user added";
            msgOkElement.classList.remove('hidden');


            setTimeout(() => {
                msgOkElement.classList.add('hidden');
            }, 3000);


            document.getElementById('addForm').reset();


        } catch (error) {
            console.error("Error creating product:", error);
            const msgfailElement = document.getElementById('msgfail');
            const msgerrextElement = document.getElementById('Msgerr');

            if (error.message.includes("409")) {
                msgerrextElement.textContent = "user already exists.";
            } else {
                msgerrextElement.textContent = `Error: ${error.message}`;
            }

            msgfailElement.classList.remove('hidden');

            setTimeout(() => {
                msgfailElement.classList.add('hidden');
            }, 3000);
        }
    }

    async function displayusers() {
        try {
            const response = await fetch('http://localhost:3002/api/userpage/user-list', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                },
            });

            if (!response.ok) {
                const errorMessage = await response.text();
                throw new Error(`Error ${response.status}: ${errorMessage}`);
            }

            const data = await response.json();
            console.log('Response from API:', data);

            // Counters for each user type
            let countStudents = 0;
            let countFaculty = 0;
            let countAdmin = 0;

            // Get the table body where users will be displayed
            const displayUsersTable = document.getElementById('displayusers');
            displayUsersTable.innerHTML = ''; // Clear the table before adding new rows

            // Create a reference to the search input element
            const searchInput = document.getElementById('searchInput');

            // Filter users by roll_no or name dynamically based on search input
            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.toLowerCase();
                const filteredUsers = data.users.filter(user => {
                    // Filter users by roll_no or name (case insensitive)
                    return user.roll_no.toString().includes(searchTerm) || user.name.toLowerCase().includes(searchTerm);
                });

                // Update the table with filtered users
                updateTable(filteredUsers);
            });

            // Function to update the table with filtered users
            function updateTable(users) {
                // Clear the table before adding new rows
                displayUsersTable.innerHTML = '';


                users.forEach(user => {
                    const row = document.createElement('tr');
                    row.classList.add('bg-white', 'divide-y', 'divide-gray-200');

                    // Create cells for user details
                    const cellName = document.createElement('td');
                    cellName.classList.add('px-6', 'py-4', 'whitespace-nowrap');
                    cellName.innerHTML = `
                <div class="flex items-center">
                    <div class="ml-4">
                        <div class="text-sm font-medium text-gray-900">${user.name}</div>
                        <div class="text-md text-gray-700">${user.roll_no}</div>
                    </div>
                </div>
                `;
                    row.appendChild(cellName);

                    const cellUserType = document.createElement('td');
                    cellUserType.classList.add('px-6', 'py-4', 'whitespace-nowrap');
                    let userType = '';
                    let userTypeClass = '';

                    if (user.is_faculty === 0) {
                        userType = 'Student';
                        userTypeClass = 'bg-green-100 text-green-800'; // Green for Student
                        countStudents++;
                    } else if (user.is_faculty === 1) {
                        userType = 'Faculty';
                        userTypeClass = 'bg-blue-100 text-blue-800'; // Blue for Faculty
                        countFaculty++;
                    } else if (user.is_faculty === 2) {
                        userType = 'Admin';
                        userTypeClass = 'bg-purple-100 text-purple-800'; // Purple for Admin
                        countAdmin++;
                    }

                    cellUserType.innerHTML = `
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${userTypeClass}">
                    ${userType}
                </span>
                `;
                    row.appendChild(cellUserType);



                    // Issue counts and components
                    const cellIssueDetails = document.createElement('td');
                    cellIssueDetails.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-sm', 'text-gray-500');
                    cellIssueDetails.innerHTML = `
                <div class="ml-4">
                    <div class="text-md font-medium text-gray-900">
                        Total no of Components issued: <span>${user.total_component_count}</span>
                    </div>
                    <div class="text-md text-gray-900">
                        current components: <span>${user.total_component_count_not_returned}</span>
                    </div>
                </div>
                `;
                    row.appendChild(cellIssueDetails);

                    // Total issue count cell
                    const cellTotalIssues = document.createElement('td');
                    cellTotalIssues.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-md', 'text-gray-900');
                    cellTotalIssues.textContent = user.total_issue_count;
                    row.appendChild(cellTotalIssues);

                    // Actions cell (View details and Update buttons)
                    const cellActions = document.createElement('td');
                    cellActions.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-sm', 'font-medium');
                    cellActions.innerHTML = `
                <button class="px-4 py-2 bg-sky-500 text-white font-bold rounded-md hover:bg-sky-600 transition duration-300 focus:outline-none">View details</button>
                `;
                    row.appendChild(cellActions);

                    // Append the row to the table
                    displayUsersTable.appendChild(row);
                });

                // Update the dashboard cards with the counts
                document.getElementById('Totalstudent').textContent = `${countStudents} `;
                document.getElementById('Totalfaculty').textContent = `${countFaculty} `;

            }

            // Initially populate the table with all users
            updateTable(data.users);

        } catch (error) {
            console.error('Error fetching user data:', error);
        }
    }



    displayusers()
</script>