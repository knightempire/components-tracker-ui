<!DOCTYPE html>
<html lang="en">

<head>
    <title>Amuda - Dashboard </title>
    <!-- [Meta] -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <script src="https://cdn.tailwindcss.com"></script>


    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" id="main-font-link">

    <link rel="stylesheet" href="../assets/fonts/tabler-icons.min.css">
  
    <link rel="stylesheet" href="../assets/fonts/feather.css">
    <!-- [Font Awesome Icons] https://fontawesome.com/icons -->
    <link rel="stylesheet" href="../assets/fonts/fontawesome.css">
    <!-- [Material Icons] https://fonts.google.com/icons -->
    <link rel="stylesheet" href="../assets/fonts/material.css">
    <!-- [Template CSS Files] -->
    <link rel="stylesheet" href="../assets/css/style.css" id="main-style-link">
    <link rel="stylesheet" href="../assets/css/style-preset.css">
    <link rel="stylesheet" href="./css/main.css">
    <script src="./js/main.js"></script>
</head>
<!-- [Head] end -->
<!-- [Body] Start -->

<body>
    <!-- [ Pre-loader ] start -->
    <div class="loader-bg">
        <div class="loader-track">
            <div class="loader-fill"></div>
        </div>
    </div>
    <!-- [ Pre-loader ] End -->
    <!-- [ Sidebar Menu ] start -->
    <nav class="pc-sidebar">
        <div class="navbar-wrapper">
            <div class="m-header">
                <a href="../dashboard/index.html" class="b-brand text-primary">
                    <!-- ========   Change your logo from here   ============ -->
                    LAB
                </a>
            </div>
            <div class="navbar-content">
                <ul class="pc-navbar">

                    <li class="pc-item">
                        <a href="../dashboard/index.html" class="pc-link"><span class="pc-micon"><i class="ti ti-dashboard"></i></span><span
              class="pc-mtext">Default</span></a>
                    </li>


                    <li class="pc-item">
                        <a href="./user.html" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-users"></i></span>
                            <span class="pc-mtext">Users</span>
                        </a>
                    </li>
                    <li class="pc-item">
                        <a href="./product.html" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-tool"></i></span>
                            <span class="pc-mtext">Products</span>
                        </a>
                    </li>
                    <li class="pc-item">
                        <li class="pc-item pc-hasmenu">
                            <a href="#!" class="pc-link"><span class="pc-micon"><i class="ti ti-note"></i></span><span class="pc-mtext">Issued </span><span class="pc-arrow"><i data-feather="chevron-right"></i></span></a>
                            <ul class="pc-submenu">
                                <li class="pc-item"><a class="pc-link" href="./issue.html">Issue</a></li>
                                <li class="pc-item"><a class="pc-link" href="./pending.html">Pending</a></li>

                            </ul>
                        </li>

                </ul>

            </div>
        </div>
    </nav>
    <!-- [ Sidebar Menu ] end -->
    <!-- [ Header Topbar ] start -->
    <header class="pc-header">
        <div class="header-wrapper">
            <!-- [Mobile Media Block] start -->
            <div class="me-auto pc-mob-drp">
                <ul class="list-unstyled">
                    <li class="pc-h-item header-mobile-collapse">
                        <a href="#" class="pc-head-link head-link-secondary ms-0" id="sidebar-hide">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>
                    <li class="pc-h-item pc-sidebar-popup">
                        <a href="#" class="pc-head-link head-link-secondary ms-0" id="mobile-collapse">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>

                    <li class="pc-h-item d-none d-md-inline-flex">
                        <h3>Hello admin</h3>
                    </li>
                </ul>
            </div>
            <!-- [Mobile Media Block end] -->
            <div class="ms-auto">
                <ul class="list-unstyled">

                    <li class="dropdown pc-h-item header-user-profile">
                        <a class="pc-head-link head-link-primary dropdown-toggle arrow-none me-0" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                          Logout

                        </a>

                    </li>
                </ul>
            </div>
        </div>
    </header>
    <!-- [ Header ] end -->



    <!-- [ Main Content ] start -->
    <div class="pc-container">
        <div class="pc-content">
            <!-- [ Main Content ] start -->


            <div class="row">
                <!-- [ sample-page ] start -->

                <!-- Card 1 -->
                <div class="col-xl-3 col-md-6">
                    <div class="card dashnum-card dashnum-card-small overflow-hidden">
                        <span class="round bg-primary small"></span>
                        <span class="round bg-primary big"></span>
                        <div class="card-body p-3">
                            <div class="d-flex align-items-center">
                                <div class="avtar avtar-lg bg-light-primary">
                                    <i class="text-primary ti ti-wallet"></i>
                                </div>
                                <div class="ms-2">
                                    <h4 class="mb-1" id="displaytotalcomponents">$550K <i class="ti ti-arrow-up-right-circle opacity-50"></i></h4>
                                    <p class="mb-0 opacity-50 text-md">Components Availability </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 2 -->
                <div class="col-xl-3 col-md-6">
                    <div class="card dashnum-card dashnum-card-small overflow-hidden">
                        <span class="round bg-warning small"></span>
                        <span class="round bg-warning big"></span>
                        <div class="card-body p-3">
                            <div class="d-flex align-items-center">
                                <div class="avtar avtar-lg bg-light-warning">
                                    <i class="text-warning ti ti-credit-card"></i>
                                </div>
                                <div class="ms-2">
                                    <h4 class="mb-1" id="displaytotaloutofstock">$550K <i class="ti ti-arrow-up-right-circle opacity-50"></i></h4>
                                    <p class="mb-0 opacity-50 text-md"> Components Out of stock </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 3 -->
                <div class="col-xl-3 col-md-6">
                    <div class="card dashnum-card dashnum-card-small overflow-hidden">
                        <span class="round bg-success small"></span>
                        <span class="round bg-success big"></span>
                        <div class="card-body p-3">
                            <div class="d-flex align-items-center">
                                <div class="avtar avtar-lg bg-light-success">
                                    <i class="text-success ti ti-wallet"></i>
                                </div>
                                <div class="ms-2">
                                    <h4 class="mb-1" id="displaytotaldamage">$550K <i class="ti ti-arrow-up-right-circle opacity-50"></i></h4>
                                    <p class="mb-0 opacity-50 text-md">Components Damaged</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Two buttons in the rightmost end -->
                <div class="col-xl-3 col-md-3 ms-auto d-flex justify-content-end align-items-center gap-3">
                    <!-- The buttons won't take up the entire height of the row, and they will be centered vertically within their column -->
                    <!-- <button class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300">
                        Update product
                    </button> -->
                    <button class="bg-purple-500 text-white px-6 py-2 rounded-lg hover:bg-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300" onclick="display()">
                        Add product
                    </button>
                </div>

                <!-- [ sample-page ] end -->
            </div>

            <div class="flex justify-center items-center hidden" id="msgok">
                <div class="flex flex-col gap-2 w-60 sm:w-72 text-[10px] sm:text-xs z-50">
                    <div class="success-alert cursor-default flex items-center justify-between w-full h-12 sm:h-14 rounded-lg bg-[#232531] px-[10px]">
                        <div class="flex gap-2">
                            <div class="text-[#2b9875] bg-white/5 backdrop-blur-xl p-1 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-white"> successfully :)</p>
                                <p class="text-gray-500" id="Msg">Product added</p>
                            </div>
                        </div>
                        <button class="text-gray-600 text-gray-600 hover:bg-white/5 p-1 rounded-md transition-colors ease-linear">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="flex justify-center items-center flex-col gap-2  text-[10px] hidden" id="msgfail">
                <div class="error-alert cursor-default flex items-center justify-between w-full h-12 sm:h-14 rounded-lg bg-[#232531] px-[10px]">
                    <div class="flex gap-2">
                        <div class="text-[#d65563] bg-white/5 backdrop-blur-xl p-1 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                <path
                                  stroke-linecap="round"
                                  stroke-linejoin="round"
                                  d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"
                                ></path>
                            </svg>
                        </div>
                        <div>
                            <p class="text-white">Please try again</p>
                            <p class="text-gray-500" id="Msgerr">This is the description part</p>
                        </div>
                    </div>
                    <button class="text-gray-600 hover:bg-white/10 p-1 rounded-md transition-colors ease-linear">
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke-width="1.5"
                          stroke="currentColor"
                          class="w-6 h-6"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M6 18 18 6M6 6l12 12"
                          ></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="mainscreen" id="mainscreen">
                <div class="row mt-4">
                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-header flex flex-col sm:flex-row sm:justify-between sm:items-center">
                                <!-- Title and Search Bar within the same flex container -->
                                <div class="flex w-full items-center sm:w-auto sm:mr-4">
                                    <!-- Title as a div (stays on the left) -->
                                    <div class="text-3xl font-bold sm:mr-4">Products list</div>
                                </div>

                                <!-- Search Bar (Stacked below on small screens) -->
                                <div class="relative sm:w-64 w-full">
                                    <!-- Feather Search Icon and Input -->
                                    <i data-feather="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"></i>
                                    <input id="searchInput" type="search" class="pl-10 pr-4 py-2 border border-black rounded-lg shadow-none focus:outline-none w-full" placeholder="Search by Roll No or Name...">
                                </div>

                            </div>

                            <div class="card-body">
                                <!-- Add a wrapper div to make the table scrollable on smaller screens -->
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200">
                                        <thead class="bg-blue-100">
                                            <tr>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Name
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Availability
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Current Issued
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    damaged
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Total count
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    no of times Issued
                                                </th>
                                                <th scope="col" class="px-6 py-3 text-left text-md font-medium text-gray-500 uppercase tracking-wider">
                                                    Actions
                                                </th>
                                            </tr>
                                        </thead>

                                        <tbody class="bg-white divide-y divide-gray-200" id="displayproducts">
                                            <tr>
                                                <td class="px-6 py-4 whitespace-nowrap text-md text-gray-900">
                                                    component name
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap text-md text-gray-900" id="availability">
                                                    in_count
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap text-md  text-gray-900" id="current_issued">
                                                    out_count
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap text-md text-gray-900" id="damage_count">
                                                    damaged count
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap text-md text-gray-900" id="total_count">
                                                    total count
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap text-md text-gray-900" id="total_issued">
                                                    total_issued
                                                </td>

                                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                    <button class="px-4 py-2 bg-sky-500 text-white font-bold rounded-md hover:bg-sky-600 transition duration-300 focus:outline-none">View details</button>
                                                    <button class="px-4 py-2 bg-purple-500 text-white font-bold rounded-md hover:bg-purple-600 transition duration-300 focus:outline-none" onclick="pageform()">Update</button>

                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>


            </div>


            <div class="form card mt-4 p-6 hidden" id="displaymainform">
                <form id="addForm" onsubmit="createProduct()">
                    <div class="mt-6 md:mt-10 text-center font-bold text-3xl font-bold md:text-xl">Add Components</div>

                    <div class="flex flex-wrap -mx-4 mt-6">
                        <div class="w-full md:w-2/3 px-4 mt-4">
                            <label for="newComponents" class="block text-md font-semibold text-gray-700 mb-2">Component Name</label>
                            <input type="text" id="newComponents" name="newComponents" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>

                        <div class="w-full md:w-1/3 px-4 mt-4">
                            <label for="newAvailability" class="block text-md font-semibold text-gray-700 mb-2">Availability</label>
                            <input type="number" id="newAvailability" name="newAvailability" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>
                    </div>

                    <div class="flex flex-wrap -mx-4 mt-6">
                        <div class="w-full md:w-1/3 px-4 mt-4">
                            <label for="newDamaged" class="block text-md font-semibold text-gray-700 mb-2">Damaged</label>
                            <input type="number" id="newDamaged" name="newDamaged" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" value="0" required>
                        </div>

                        <div class="w-full md:w-1/3 px-4 mt-4">
                            <label for="newIssuedCount" class="block text-md font-semibold text-gray-700 mb-2">Issued Component Count</label>
                            <input type="number" id="newIssuedCount" name="newIssuedCount" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" value="0" required>
                        </div>

                        <div class="w-full md:w-1/3 px-4 mt-4">
                            <label for="total" class="block text-md font-semibold text-gray-700 mb-2">Total</label>
                            <input type="text" id="newtotal" name="newtotal" class="mt-2 block w-full px-4 py-2 border border-gray-500 rounded-lg bg-gray-100 cursor-not-allowed" value="0" readonly>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <br><br>
                    <div class="text-center mt-6">
                        <button type="submit" class="cursor-pointer rounded-lg bg-purple-700 px-6 py-2 sm:py-3 text-md font-semibold text-white mr-4">Submit</button>
                    </div>
                </form>
            </div>




            <div class="form card mt-4 p-6 hidden" id="pageform">
                <form id="updateForm" onsubmit="updateProduct(event)">
                    <button type="button" onclick="pageform()" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>

                    <div class="mt-6 md:mt-10 text-center font-bold text-3xl font-bold md:text-xl">Update Components</div>


                    <div class="flex flex-wrap -mx-4 mt-6">

                        <div class="w-full md:w-1/2 px-4 mt-4 hidden">
                            <label for="components" class="block text-md font-semibold text-gray-700 mb-2">Component Name</label>
                            <input type="text" id="updatecomponentsid" name="components" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>



                        <div class="w-full md:w-1/2 px-4 mt-4">
                            <label for="components" class="block text-md font-semibold text-gray-700 mb-2">Component Name</label>
                            <input type="text" id="updatecomponents" name="components" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>


                        <div class="w-full md:w-1/2 px-4 mt-4">

                            <div class="flex flex-wrap -mx-2">

                                <div class="w-full md:w-1/3 px-2 mt-4">
                                    <label for="totalAvailability" class="block text-md font-semibold text-gray-700 mb-2">Total Availability</label>
                                    <input type="text" id="updatetotalAvailability" name="totalAvailability" class="mt-2 block w-full px-4 py-2 border border-gray-500 rounded-lg bg-gray-100 cursor-not-allowed" value="0" readonly>
                                </div>


                                <div class="w-full md:w-1/3 px-2 mt-4">
                                    <label for="totalIssue" class="block text-md font-semibold text-gray-700 mb-2">Total Issue</label>
                                    <input type="text" id="updatetotalIssue" name="totalIssue" class="mt-2 block w-full px-4 py-2 border border-gray-500 rounded-lg bg-gray-100 cursor-not-allowed" value="0" readonly>
                                </div>


                                <div class="w-full md:w-1/3 px-2 mt-4">
                                    <label for="totalDamage" class="block text-md font-semibold text-gray-700 mb-2">Total Damage</label>
                                    <input type="text" id="updatetotalDamage" name="totalDamage" class="mt-2 block w-full px-4 py-2 border border-gray-500 rounded-lg bg-gray-100 cursor-not-allowed" value="0" readonly>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="flex flex-wrap -mx-4 mt-6">

                        <div class="w-full md:w-1/3 px-4 mt-4">
                            <label for="availability" class="block text-md font-semibold text-gray-700 mb-2">Availability</label>
                            <input type="number" id="updateavailability" name="availability" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>


                        <div class="w-full md:w-1/3 px-4 mt-4">
                            <label for="damaged" class="block text-md font-semibold text-gray-700 mb-2">Damaged</label>
                            <input type="number" id="updatedamaged" name="damaged" class="mt-2 block w-full px-4 py-2 border border-black rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>


                        <div class="w-full md:w-1/3 px-4 mt-4">
                            <label for="total" class="block text-md font-semibold text-gray-700 mb-2">Total</label>
                            <input type="text" id="updatetotal" name="total" class="mt-2 block w-full px-4 py-2 border border-gray-500 rounded-lg bg-gray-100 cursor-not-allowed" value="0" readonly>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <br><br>
                    <div class="text-center mt-6">
                        <button type="submit" class="cursor-pointer rounded-lg bg-purple-700 px-6 py-2 sm:py-3 text-md font-semibold text-white mr-4">Submit</button>
                    </div>
                </form>
            </div>




            <script>
                //add button display toggle
                function display() {

                    var mainscreen = document.getElementById('mainscreen');
                    var displaymainform = document.getElementById('displaymainform');
                    var button = document.querySelector('button');
                    var pageform = document.getElementById('pageform');


                    if (displaymainform.classList.contains('hidden')) {
                        pageform.classList.add('hidden');
                        mainscreen.classList.add('hidden');
                        displaymainform.classList.remove('hidden');

                        button.textContent = 'Close';

                    } else {

                        mainscreen.classList.remove('hidden');
                        displaymainform.classList.add('hidden');
                        button.textContent = 'Add product';

                    }
                }


                function pageform(product_id) {


                    // Get the elements by their IDs
                    var mainscreen = document.getElementById('mainscreen');
                    var pageform = document.getElementById('pageform');

                    // Toggle visibility of the elements
                    if (pageform.classList.contains('hidden')) {
                        // If mainscreen is hidden, show it and hide pageform
                        mainscreen.classList.add('hidden');
                        pageform.classList.remove('hidden');
                        displayupdateform(product_id);
                    } else {
                        // If mainscreen is visible, hide it and show pageform
                        mainscreen.classList.remove('hidden');
                        pageform.classList.add('hidden');
                    }
                }
            </script>

            <!-- Include Feather Icons -->
            <script src="https://unpkg.com/feather-icons"></script>
            <script>
                feather.replace(); // Initializes the Feather Icons
            </script>




            <!-- [ Main Content ] end -->
        </div>
    </div>
    <!-- [ Main Content ] end -->
    <footer class="pc-footer">
        <div class="footer-wrapper container-fluid">
            <div class="row">
                <div class="col-sm-6 my-1">
                    <p class="m-0">Components tracker &#9829; crafted by Team <a href="https://themeforest.net/user/Team_name" target="_blank">Team_name</a></p>
                </div>
                <div class="col-sm-6 ms-auto my-1">
                    <ul class="list-inline footer-link mb-0 justify-content-sm-end d-flex">
                        <li class="list-inline-item"><a href="../index.html">Home</a></li>
                        <li class="list-inline-item"><a href="https://Team_name.gitbook.io/Components tracker-bootstrap/" target="_blank">Documentation</a></li>
                        <li class="list-inline-item"><a href="https://Team_name.support-hub.io/" target="_blank">Support</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <!-- Required Js -->
    <script src="../assets/js/plugins/popper.min.js"></script>
    <script src="../assets/js/plugins/simplebar.min.js"></script>
    <script src="../assets/js/plugins/bootstrap.min.js"></script>
    <script src="../assets/js/fonts/custom-font.js"></script>
    <script src="../assets/js/pcoded.js"></script>
    <script src="../assets/js/plugins/feather.min.js"></script>





    <script>
        layout_change('light');
    </script>




    <script>
        font_change("Roboto");
    </script>


    <script>
        change_box_container('false');
    </script>


    <script>
        layout_caption_change('true');
    </script>




    <script>
        layout_rtl_change('false');
    </script>


    <script>
        preset_change("preset-1");
    </script>



</body>
<!-- [Body] end -->

</html>



<script>
    displayProducts()

    //function of total adding a proudct
    function updateTotal() {
        const availability = parseInt(document.getElementById('newAvailability').value) || 0;
        const damaged = parseInt(document.getElementById('newDamaged').value) || 0;
        const issuedCount = parseInt(document.getElementById('newIssuedCount').value) || 0;

        const total = availability + damaged + issuedCount;
        document.getElementById('newtotal').value = total;
    }


    document.getElementById('newAvailability').addEventListener('input', updateTotal);
    document.getElementById('newDamaged').addEventListener('input', updateTotal);
    document.getElementById('newIssuedCount').addEventListener('input', updateTotal);


    document.getElementById('addForm').addEventListener('submit', function(event) {
        event.preventDefault();
        updateTotal();
    });



    //add product
    async function createProduct() {
        const formData = {
            product_name: document.getElementById('newComponents').value,
            in_count: parseInt(document.getElementById('newAvailability').value) || 0,
            out_count: parseInt(document.getElementById('newIssuedCount').value) || 0,
            damage_count: parseInt(document.getElementById('newDamaged').value) || 0,
        };

        try {
            const response = await fetch(`http://localhost:3002/api/product/create`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),
            });

            if (!response.ok) {
                const errorMessage = await response.text();
                throw new Error(`Error ${response.status}: ${errorMessage}`);
            }

            const data = await response.json();
            console.log(data);

            displayProducts()
            display();


            const msgOkElement = document.getElementById('msgok');
            const msgTextElement = document.getElementById('Msg');
            msgTextElement.textContent = data.message || "Product added";
            msgOkElement.classList.remove('hidden');


            setTimeout(() => {
                msgOkElement.classList.add('hidden');
            }, 3000);


            document.getElementById('addForm').reset();
            updateTotal();

        } catch (error) {
            console.error("Error creating product:", error);
            const msgfailElement = document.getElementById('msgfail');
            const msgerrextElement = document.getElementById('Msgerr');

            if (error.message.includes("409")) {
                msgerrextElement.textContent = "This component already exists.";
            } else {
                msgerrextElement.textContent = `Error: ${error.message}`;
            }

            msgfailElement.classList.remove('hidden');

            setTimeout(() => {
                msgfailElement.classList.add('hidden');
            }, 3000);
        }
    }


    // Function to display products from /products-list API
    async function displayProducts() {
        try {
            const response = await fetch('http://localhost:3002/api/product/products-list', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                },
            });

            if (!response.ok) {
                const errorMessage = await response.text();
                throw new Error(`Error ${response.status}: ${errorMessage}`);
            }

            const data = await response.json();

            if (data.success && Array.isArray(data.products)) {

                let totalComponents = 0;
                let totalOutOfStock = 0;
                let totalDamaged = 0;

                const displayProductsTable = document.getElementById('displayproducts');
                displayProductsTable.innerHTML = ''; // Clear the table

                // Create a reference to the search input element
                const searchInput = document.getElementById('searchInput');

                // Filter products by product_name dynamically based on search input
                searchInput.addEventListener('input', () => {
                    const searchTerm = searchInput.value.toLowerCase();
                    const filteredProducts = data.products.filter(product => {
                        return product.product_name.toLowerCase().includes(searchTerm); // Filter by product_name
                    });

                    // Update the table with filtered products
                    updateTable(filteredProducts);
                });

                // Function to update the table with products
                function updateTable(products) {
                    displayProductsTable.innerHTML = ''; // Clear existing rows

                    products.forEach(product => {
                        const row = document.createElement('tr');

                        const cellProductName = document.createElement('td');
                        cellProductName.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-md', 'text-gray-900');
                        cellProductName.textContent = product.product_name;
                        row.appendChild(cellProductName);

                        const cellInCount = document.createElement('td');
                        cellInCount.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-md', 'text-gray-900');
                        cellInCount.textContent = product.in_count;
                        row.appendChild(cellInCount);

                        const cellOutCount = document.createElement('td');
                        cellOutCount.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-md', 'text-gray-900');
                        cellOutCount.textContent = product.out_count;
                        row.appendChild(cellOutCount);

                        const cellDamageCount = document.createElement('td');
                        cellDamageCount.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-md', 'text-gray-900');
                        cellDamageCount.textContent = product.damage_count;
                        row.appendChild(cellDamageCount);

                        const cellTotalCount = document.createElement('td');
                        cellTotalCount.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-md', 'text-gray-900');
                        const totalCount = product.in_count + product.out_count + product.damage_count;
                        cellTotalCount.textContent = totalCount;
                        row.appendChild(cellTotalCount);

                        const cellIssuedCount = document.createElement('td');
                        cellIssuedCount.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-md', 'text-gray-900');
                        cellIssuedCount.textContent = product.issued_count;
                        row.appendChild(cellIssuedCount);

                        const cellActions = document.createElement('td');
                        cellActions.classList.add('px-6', 'py-4', 'whitespace-nowrap', 'text-sm', 'font-medium');
                        cellActions.innerHTML = `
                    <button class="px-4 py-2 bg-sky-500 text-white font-bold rounded-md hover:bg-sky-600 transition duration-300 focus:outline-none">View details</button>
                    <button class="px-4 py-2 bg-purple-500 text-white font-bold rounded-md hover:bg-purple-600 transition duration-300 focus:outline-none" onclick="pageform(${product.product_id})">Update</button>
                `;
                        row.appendChild(cellActions);

                        displayProductsTable.appendChild(row);

                        totalComponents += product.in_count + product.out_count;
                        if (product.in_count === 0) {
                            totalOutOfStock += 1;
                        }
                        totalDamaged += product.damage_count;
                    });

                    // Update the dashboard cards with totals
                    document.getElementById('displaytotalcomponents').textContent = `${totalComponents}`;
                    document.getElementById('displaytotaloutofstock').textContent = totalOutOfStock;
                    document.getElementById('displaytotaldamage').textContent = `${totalDamaged}`;
                }

                // Initially populate the table with all products
                updateTable(data.products);

            } else {
                const displayProductsTable = document.getElementById('displayproducts');
                displayProductsTable.innerHTML = '<tr><td colspan="7" class="px-6 py-4 text-center text-red-500">No products available</td></tr>';
            }
        } catch (error) {
            console.error("Error fetching products:", error);
            const displayProductsTable = document.getElementById('displayproducts');
            displayProductsTable.innerHTML = '<tr><td colspan="7" class="px-6 py-4 text-center text-red-500">Failed to fetch products.</td></tr>';
        }
    }

    // Function to display products from /products-list API 
    async function displayupdateform(product_id) {
        console.log('Fetching data for product ID:', product_id);

        try {

            const response = await fetch('http://localhost:3002/api/product/product-info', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    p_id: product_id,
                }),
            });


            if (!response.ok) {
                const errorMessage = await response.text();
                throw new Error(`Error ${response.status}: ${errorMessage}`);
            }

            const data = await response.json();
            console.log('Product data:', data);


            if (data.success) {
                document.getElementById('updatecomponentsid').value = data.product.product_id;
                document.getElementById('updatecomponents').value = data.product.product_name;
                document.getElementById('updatetotalAvailability').value = data.product.in_count;
                document.getElementById('updatetotalIssue').value = data.product.issued_count;
                document.getElementById('updatetotalDamage').value = data.product.damage_count;


                updatenewTotal();
            } else {
                console.error('Error:', data.message);
            }

        } catch (error) {

            console.error('Error fetching product info:', error);
        }
    }

    // Calculate the total - updateproduct
    function updatenewTotal() {
        const availability = parseInt(document.getElementById('updatetotalAvailability').value) || 0;
        const damaged = parseInt(document.getElementById('updatetotalIssue').value) || 0;
        const issuedCount = parseInt(document.getElementById('updatetotalDamage').value) || 0;
        const updateavailablityCount = parseInt(document.getElementById('updateavailability').value) || 0;
        const updatedamagedCount = parseInt(document.getElementById('updatedamaged').value) || 0;
        const total = availability + damaged + issuedCount + updatedamagedCount + updateavailablityCount;
        document.getElementById('updatetotal').value = total;
    }


    document.getElementById('updateavailability').addEventListener('input', updatenewTotal);
    document.getElementById('updatedamaged').addEventListener('input', updatenewTotal);


    document.getElementById('updateForm').addEventListener('submit', function(event) {
        event.preventDefault();
        updatenewTotal();
    });



    //api to updateproduct
    async function updateProduct(event) {
        event.preventDefault();


        const updateavailability = document.getElementById('updateavailability').value;
        const updatedamaged = document.getElementById('updatedamaged').value;
        const p_id = document.getElementById('updatecomponentsid').value;

        // Print the values to the console
        console.log('updateavailability:', updateavailability);
        console.log('updatedamaged:', updatedamaged);
        console.log('p_id:', p_id);


        const updateData = {
            p_id,
            new_in_count: updateavailability,
            new_damaged_count: updatedamaged,
        };

        try {

            const response = await fetch('http://localhost:3002/api/product/update-stock', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(updateData),
            });


            if (!response.ok) {
                const errorMessage = await response.text();
                throw new Error(`Error ${response.status}: ${errorMessage}`);
            }


            const data = await response.json();
            console.log('Stock updated successfully:', data);


            const msgOkElement = document.getElementById('msgok');
            const msgTextElement = document.getElementById('Msg');
            msgTextElement.textContent = data.message || "Stock updated successfully";
            msgOkElement.classList.remove('hidden');

            pageform();
            displayProducts()
            updatenewTotal();
            document.getElementById('updateForm').reset();

            setTimeout(() => {
                msgOkElement.classList.add('hidden');
            }, 3000);

        } catch (error) {

            console.error("Error updating stock:", error);
            const msgfailElement = document.getElementById('msgfail');
            const msgerrextElement = document.getElementById('Msgerr');
            msgerrextElement.textContent = `Error: ${error.message}`;

            msgfailElement.classList.remove('hidden');

            setTimeout(() => {
                msgfailElement.classList.add('hidden');
            }, 3000);
        }
    }
</script>